# ðŸ› ï¸ DIY Hardware Modification Guide

> **Project Goal:** Converting a proprietary "dumb" aroma diffuser (Miyoscent) into a locally controlled IoT device using Sonoff SV.

This document details the hardware teardown, component replacement, and wiring modifications required to build the smart atomizer.

---

## ðŸ“‹ Bill of Materials (BOM)

| Component | Description | Role |
| :--- | :--- | :--- |
| **Miyoscent Diffuser** | Standard commercial unit | The "Donor" (Shell & Fluid tank). |
| **Sonoff SV** | Safe Voltage WiFi Relay | The new MCU/Controller. |
| **Atomizer Driver** | Ultrasonic Transducer Plate | Generates the mist. |
| **Power Supply** | 5V DC Source | Powering the Sonoff & Driver. |

Miyoscent Diffuser - 
<img width="177" height="177" alt="image" src="https://github.com/user-attachments/assets/054bd433-2b92-4366-8cfc-c5f7e016db98" />

Ultrasonic Atomization Maker 20mm - 
<img width="177" height="177" alt="image" src="https://github.com/user-attachments/assets/5c7af0f7-fd53-4f2e-b34f-6b3f527fa6d8" />

---

## ðŸ”§ The Build Process

### 1. Teardown & "Lobotomy"
The original proprietary logic board (PCB) was completely removed from the Miyoscent casing. This removes the manual buttons and the original limited firmware, leaving only the plastic shell and the tank assembly.

### 2. The Controller: Sonoff SV
We selected the **Sonoff SV (Safe Voltage)** because it operates on low DC voltage and provides a clean, isolate-able relay.

* **Voltage Modification:** The Sonoff SV was modified to bypass its input regulator constraints to operate smoothly on a **5V** standard USB power supply.
* **Wiring:**
    * **Input:** 5V DC.
    * **Output (Relay):** Connected directly to the **Atomizer Driver Plate**.

### 3. Integration
The driver plate and the Sonoff SV were mounted inside the original casing. The ultrasonic disc was sealed against the liquid tank using the original gasket to prevent leaks.

---

## âš¡ Technical Constraints & Logic

### Why Time-Based Control?
A common question is why we control the **duration** of the spray rather than the **intensity** (volume).

1.  **The Limitation:** The Sonoff SV acts as a **Binary Relay** (On/Off switch). It simply closes or opens a circuit.
2.  **Intensity Requirements:** To control mist intensity (make it stronger or weaker), the driver plate requires a **PWM (Pulse Width Modulation)** signal to adjust the frequency/duty cycle of the ultrasonic vibrations.
3.  **The Result:** Since the Sonoff SV cannot natively output complex PWM signals to this specific driver without significant ESPHome firmware rewriting and additional MOSFET hardware, we opted for **Binary Control**.
    * **State:** Full Power (On) / Off.
    * **Dosage Control:** Achieved by limiting the *time* the device is active (e.g., 10-second bursts) rather than lowering the power.

---

## ðŸ“¸ Visual Reference

*(Add photos of the open casing, the Sonoff SV wiring, and the driver plate here)*

> **Warning:** This modification involves voiding the warranty of the original device and working with exposed electronics. Ensure proper insulation to protect the components from moisture generated by the atomizer.
